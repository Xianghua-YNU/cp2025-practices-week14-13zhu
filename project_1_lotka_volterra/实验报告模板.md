# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** [请填写您的姓名]  王梦
**学号：** [请填写您的学号]  20231050193
**完成日期：** [请填写完成日期]  5.30
**实验时间：** [请填写实验用时]3h

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

请简要描述Lotka-Volterra方程组的数学形式和各参数的生物学意义：

```
[请在此处填写方程组和参数说明]
、
 
1. Lotka - Volterra方程组的数学形式（以捕食者 - 猎物模型为例 ）
 
设猎物的种群数量为N_1，捕食者的种群数量为N_2，则Lotka - Volterra方程组为：
\frac{dN_1}{dt}=r_1N_1 - \alpha N_1N_2
\frac{dN_2}{dt}= - r_2N_2+\beta N_1N_2
 
2. 各参数的生物学意义
 
- r_1: 表示猎物在没有捕食者存在时的内禀增长率。即猎物种群在理想条件（食物充足、空间充裕、无天敌等）下，单位时间内种群数量增长的比例 。
- \alpha: 称为捕食系数，它描述了捕食者对猎物的捕食效率。表示每个捕食者个体单位时间内捕食猎物的数量，反映了捕食者对猎物种群增长的抑制作用强度。
- r_2: 表示捕食者在没有猎物存在时的死亡率。即当没有猎物作为食物来源时，捕食者种群数量单位时间内减少的比例。
- \beta: 表示捕食者利用猎物而增长的转换系数。它反映了每捕食一定数量的猎物，能够使捕食者种群增加的个体数量，体现了猎物对捕食者种群增长的贡献。
 
```

### 2.2 数值方法原理

请简要说明您实现的三种数值方法的基本原理：

**欧拉法：**
```
[请描述欧拉法的基本思想和公式]
```

- 基本思想：对于一阶常微分方程初值问题\frac{dy}{dx}=f(x,y)，y(x_0)=y_0，在每个小区间上，用切线近似代替曲线。即假设在小区间内函数y(x)的变化率近似为该区间起点处的导数值f(x_n,y_n)，通过不断递推来求解不同x处的y值。
- 公式：设步长为h，则有递推公式y_{n + 1}=y_n+h\cdot f(x_n,y_n)，其中n = 0,1,2,\cdots。x_{n+1}=x_n + h，从初始点(x_0,y_0)开始，利用该公式逐步计算后续点的函数值。
**改进欧拉法：**
```
[请描述改进欧拉法的改进之处]
```
改进之处：欧拉法是用单一点处（区间起点）的导数来近似整个区间上的平均导数，误差较大。改进欧拉法采用梯形公式来近似积分，对平均导数的估计更为准确。它是一种预测 - 校正方法。先使用欧拉法进行预测，得到\overline{y}_{n + 1}=y_n+h\cdot f(x_n,y_n) ，然后利用预测值\overline{y}_{n + 1}计算区间终点处的斜率f(x_{n+1},\overline{y}_{n + 1})，再对起点和终点处的斜率取平均来校正结果，得到y_{n + 1}=y_n+\frac{h}{2}[f(x_n,y_n)+f(x_{n + 1},\overline{y}_{n + 1})]。这种方法相比欧拉法，考虑了区间两端的导数信息，提高了数值求解的精度 。
**4阶龙格-库塔法：**
```
[请描述RK4方法的优势]
```
优势：
- 精度高：它通过在每个步长内计算多个点的斜率（通常是4个点），并进行加权平均来近似区间上的平均斜率，能够达到四阶精度。即在局部截断误差为O(h^5)，相比欧拉法（一阶精度，局部截断误差O(h^2)）和改进欧拉法（二阶精度，局部截断误差O(h^3)），在相同步长下能获得更精确的解。
- **适应性强(h：对各种类型的常微分方程都有较好的求解效果，不需要对不同类型的方程做过多的调整，具有广泛的适用性。
- 稳定性较好：在一定条件下，能够保证数值解的稳定性，不会出现数值解剧烈波动等不稳定情况，能较为可靠地求解常微分方程初值问题。
## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

请在此处粘贴您实现的核心函数代码片段（选择最重要的1-2个函数）：

```python
# 例如：lotka_volterra_system函数
[请粘贴您的核心代码]
```
def lotka_volterra_system(state: np.ndarray, t: float, alpha: float, beta: float,
                          gamma: float, delta: float) -> np.ndarray:
    """
    Lotka-Volterra方程组的右端函数

    参数:
        state: [x, y] 当前状态向量
        t: 时间（本系统中未显式使用）
        alpha, beta, gamma, delta: 模型参数

    返回:
        导数向量 [dx/dt, dy/dt]
    """
    x, y = state
    # 修正dxdt的计算，确保符号正确
    dxdt = alpha * x - beta * x * y  # 当x=y=1, alpha=1, beta=0.5时，dxdt = 1 - 0.5 = 0.5
    dydt = gamma * x * y - delta * y  # 当x=y=1, gamma=0.5, delta=2时，dydt = 0.5 - 2 = -1.5
    return np.array([dxdt, dydt])


```python
# 例如：runge_kutta_4函数
[请粘贴您的核心代码]
```def runge_kutta_4(f, y0: np.ndarray, t_span: Tuple[float, float],
                  dt: float, *args) -> Tuple[np.ndarray, np.ndarray]:
    """
    4阶龙格-库塔法求解常微分方程组

    参数:
        f: 微分方程组的右端函数
        y0: 初始条件向量
        t_span: 时间范围 (t_start, t_end)
        dt: 时间步长
        *args: 传递给f的额外参数

    返回:
        t: 时间数组
        y: 解数组，形状为 (len(t), len(y0))
    """
    t_start, t_end = t_span
    t = np.arange(t_start, t_end + dt, dt)
    n_steps = len(t)
    n_vars = len(y0)

    y = np.zeros((n_steps, n_vars))
    y[0] = y0

    for i in range(n_steps - 1):
        h = dt
        yi = y[i]
        ti = t[i]

        k1 = h * f(yi, ti, *args)
        k2 = h * f(yi + k1 / 2, ti + h / 2, *args)
        k3 = h * f(yi + k2 / 2, ti + h / 2, *args)
        k4 = h * f(yi + k3, ti + h, *args)

        y[i + 1] = yi + (k1 + 2 * k2 + 2 * k3 + k4) / 6

    return t, y



### 3.3 实现过程中遇到的问题

请描述您在实现过程中遇到的主要问题及解决方法：

```
[请描述遇到的问题和解决方案]
```

## 4. 实验结果

### 4.1 基本求解结果

请在此处粘贴使用4阶龙格-库塔法求解得到的种群动力学图：
![image](https://github.com/user-attachments/assets/6ef72127-004c-4b1a-9efe-2a20999a7ccc)



```
[![image](https://github.com/user-attachments/assets/ac5052b5-3cf3-44f7-8841-966748258c54)
]
图4.1: Lotka-Volterra种群动力学
左图：种群数量随时间变化；右图：相空间轨迹
```

**观察结果描述：**
```
[请描述图中观察到的现象，如周期性变化、相位关系等]
```

### 4.2 数值方法比较

请在此处粘贴三种数值方法的比较图：

```
[请粘贴方法比较图]![image](https://github.com/user-attachments/assets/3719c919-e010-4c3d-9dfd-b684cba425ae)

图4.2: 三种数值方法比较
上排：时间序列比较；下排：相空间比较
```

**比较结果分析：**

| 方法 | 计算精度 | 计算效率 | 稳定性 | 守恒量误差 |
|------|----------|----------|--------|------------|
| 欧拉法 | [填写] | [填写] | [填写] | [填写] |
| 改进欧拉法 | [填写] | [填写] | [填写] | [填写] |
| 4阶RK法 | [填写] | [填写] | [填写] | [填写] |

### 4.3 参数影响分析

请在此处粘贴不同初始条件下的结果图：

```
[请粘贴参数分析图]
图4.3: 不同初始条件的影响
```

**参数敏感性分析：**
```
[请分析不同初始条件对系统行为的影响]
```

## 5. 结果分析与讨论

### 5.1 生物学意义分析

请从生物学角度分析实验结果：

**种群动力学特征：**
```
[请分析猎物和捕食者数量变化的规律]
```

**相互作用机制：**
```
[请解释捕食者与猎物之间的相位关系]
```

**生态平衡：**
```
[请讨论系统的稳定性和平衡状态]
```

### 5.2 数值方法评估

**精度比较：**
```
[请比较三种方法的精度，并解释原因]
```

**计算效率：**
```
[请比较计算时间和资源消耗]
```

**适用性分析：**
```
[请讨论在什么情况下选择哪种方法]
```

## 6. 思考题

请回答以下思考题：

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？

**回答：**
```
[请回答]
```



**实验报告完成情况自评：**

- [ ] 完成了所有必需的函数实现
- [ ] 通过了所有测试用例
- [ 可能] 生成了所有要求的图表
- [ 没] 完成了结果分析和讨论
- [ 没] 回答了所有思考题

**总体评价：** [请对自己的实验完成情况进行总体评价]60

**建议成绩：** [请根据完成质量自评建议成绩70] / 100分
